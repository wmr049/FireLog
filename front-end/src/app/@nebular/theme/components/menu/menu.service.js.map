{"version":3,"file":"menu.service.js","sourceRoot":"","sources":["../../../../../.ng_build/theme/components/menu/menu.service.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nimport { Injectable, Inject } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { Router } from '@angular/router';\nimport { Observable } from 'rxjs/Observable';\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\nimport { ReplaySubject } from 'rxjs/ReplaySubject';\nimport 'rxjs/add/operator/publish';\n\nconst itemClick$ = new ReplaySubject(1);\nconst addItems$ = new ReplaySubject(1);\nconst navigateHome$ = new ReplaySubject(1);\nconst getSelectedItem$ = new ReplaySubject(1);\nconst itemSelect$ = new ReplaySubject(1);\nconst itemHover$ = new ReplaySubject(1);\nconst submenuToggle$ = new ReplaySubject(1);\n\n/**\n * Menu Item options\n * TODO: check if we need both URL and LINK\n */\nexport abstract class NbMenuItem {\n  /**\n   * Item Title\n   * @type {string}\n   */\n  title: string;\n  /**\n   * Item relative link (for routerLink)\n   * @type {string}\n   */\n  link?: string;\n  /**\n   * Item URL (absolute)\n   * @type {string}\n   */\n  url?: string;\n  /**\n   * Icon class name\n   * @type {string}\n   */\n  icon?: string;\n  /**\n   * Expanded by defaul\n   * @type {boolean}\n   */\n  expanded?: boolean;\n  /**\n   * Children items\n   * @type {List<NbMenuItem>}\n   */\n  children?: NbMenuItem[];\n  /**\n   * HTML Link target\n   * @type {string}\n   */\n  target?: string;\n  /**\n   * Hidden Item\n   * @type {boolean}\n   */\n  hidden?: boolean;\n  /**\n   * Item is selected when partly or fully equal to the current url\n   * @type {string}\n   */\n  pathMatch?: string = 'full'; // TODO: is not set if item is initialized by default, should be set anyway\n  /**\n   * Where this is a home item\n   * @type {boolean}\n   */\n  home?: boolean;\n  /**\n   * Whether the item is just a group (non-clickable)\n   * @type {boolean}\n   */\n  group?: boolean;\n  parent?: NbMenuItem;\n  selected?: boolean;\n  data?: any;\n  fragment?: string;\n}\n\n// TODO: map select events to router change events\n// TODO: review the interface\n/**\n * Menu Service. Allows you to listen to menu events, or to interact with a menu.\n */\n@Injectable()\nexport class NbMenuService {\n\n  /**\n   * Add items to the end of the menu items list\n   * @param {List<NbMenuItem>} items\n   * @param {string} tag\n   */\n  addItems(items: NbMenuItem[], tag?: string) {\n    addItems$.next({ tag, items });\n  }\n\n  /**\n   * Navigate to the home menu item\n   * @param {string} tag\n   */\n  navigateHome(tag?: string) {\n    navigateHome$.next({ tag });\n  }\n\n  /**\n   * Returns currently selected item. Won't subscribe to the future events.\n   * @param {string} tag\n   * @returns {Observable<{tag: string; item: NbMenuItem}>}\n   */\n  getSelectedItem(tag?: string): Observable<{ tag: string; item: NbMenuItem }> {\n    const listener = new BehaviorSubject<{ tag: string; item: NbMenuItem }>(null);\n\n    getSelectedItem$.next({ tag, listener });\n\n    return listener.asObservable();\n  }\n\n  onItemClick(): Observable<{ tag: string; item: NbMenuItem }> {\n    return itemClick$.publish().refCount();\n  }\n\n  onItemSelect(): Observable<{ tag: string; item: NbMenuItem }> {\n    return itemSelect$.publish().refCount();\n  }\n\n  onItemHover(): Observable<{ tag: string; item: NbMenuItem }> {\n    return itemHover$.publish().refCount();\n  }\n\n  onSubmenuToggle(): Observable<{ tag: string; item: NbMenuItem }> {\n    return submenuToggle$.publish().refCount();\n  }\n}\n\n@Injectable()\nexport class NbMenuInternalService {\n  private items: NbMenuItem[] = [];\n\n  constructor(private router: Router, private location: Location) {\n    this.items = [];\n  }\n\n  getItems(): NbMenuItem[] {\n    return this.items;\n  }\n\n  prepareItems(items: NbMenuItem[]) {\n    items.forEach(i => this.setParent(i));\n    items.forEach(i => this.prepareItem(i));\n  }\n\n  resetItems(items: NbMenuItem[]) {\n    items.forEach(i => this.resetItem(i));\n  }\n\n  collapseAll(items: NbMenuItem[], except?: NbMenuItem) {\n    items.forEach(i => this.collapseItem(i, except));\n  }\n\n  onAddItem(): Observable<{ tag: string; items: NbMenuItem[] }> {\n    return addItems$.publish().refCount();\n  }\n\n  onNavigateHome(): Observable<{ tag: string }> {\n    return navigateHome$.publish().refCount();\n  }\n\n  onGetSelectedItem(): Observable<{ tag: string; listener: BehaviorSubject<{ tag: string; item: NbMenuItem }> }> {\n    return getSelectedItem$.publish().refCount();\n  }\n\n  itemHover(item: NbMenuItem, tag?: string) {\n    itemHover$.next({tag, item});\n  }\n\n  submenuToggle(item: NbMenuItem, tag?: string) {\n    submenuToggle$.next({tag, item});\n  }\n\n  itemSelect(item: NbMenuItem, tag?: string) {\n    itemSelect$.next({tag, item});\n  }\n\n  itemClick(item: NbMenuItem, tag?: string) {\n    itemClick$.next({tag, item});\n  }\n\n  private resetItem(item: NbMenuItem) {\n    item.selected = false;\n\n    item.children && item.children.forEach(child => {\n      this.resetItem(child);\n    });\n  }\n\n  private collapseItem(item: NbMenuItem, except?: NbMenuItem) {\n    if (except && item === except) {\n      return;\n    }\n    item.expanded = false;\n\n    item.children && item.children.forEach(child => {\n      this.collapseItem(child);\n    });\n  }\n\n  private setParent(item: NbMenuItem) {\n    item.children && item.children.forEach(child => {\n      child.parent = item;\n      this.setParent(child);\n    });\n  }\n\n  private prepareItem(item: NbMenuItem) {\n    item.selected = false;\n\n    const exact: boolean = item.pathMatch === 'full';\n    const location: string = this.location.path();\n\n    if ((exact && location === item.link) || (!exact && location.includes(item.link))\n      || (exact && item.fragment && location.substr(location.indexOf('#') + 1).includes(item.fragment))) {\n\n      item.selected = true;\n      this.selectParent(item);\n    }\n\n    item.children && item.children.forEach(child => {\n      this.prepareItem(child);\n    });\n  }\n\n  private selectParent(item: NbMenuItem) {\n    const parent = item.parent;\n    if (parent) {\n      parent.selected = true;\n      parent.expanded = true;\n      this.selectParent(parent);\n    }\n  }\n}\n"]}